<!-- wp:paragraph -->
<p><em>TLDR: This tutorial was prompted by the recent changes to the <code>tidyr</code> package (see the tweet from Hadley Wickham below). Two functions for reshaping columns and rows (<code>gather()</code> and <code>spread()</code>) were replaced with <code>tidyr::pivot_longer()</code> and <code>tidyr::pivot_wider()</code> functions.</em></p>
<!-- /wp:paragraph -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><p>Thanks to all 2649 (!!!) people who completed my survey about table shapes! I've done analysed the data at <a href="https://t.co/hyu1o91xRm">https://t.co/hyu1o91xRm</a> and the new functions will be called pivot_longer() and pivot_wider() <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a>— Hadley Wickham (@hadleywickham) <a href="https://twitter.com/hadleywickham/status/1109816130774986753?ref_src=twsrc%5Etfw">March 24, 2019</a></p></blockquote>
<!-- /wp:quote -->

<!-- wp:heading -->
<h2>Load packages</h2>
<!-- /wp:heading -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted"># this will require the newest version of tidyr from github <br># devtools::install_github("tidyverse/tidyr") <br>library(tidyverse) <br>library(here)</pre>
<!-- /wp:preformatted -->

<!-- wp:heading -->
<h2>Objectives</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This tutorial will cover three concepts about working with data in the <code>tidyverse</code>: </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>1) tidy data,  <br>
  2) grouping, and  <br>
  3) the new pivoting verbs in <code>tidyr</code></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>A solid understanding of these topics makes it easier to manipulate and re-structure your data for visualizations and modeling in the <code>tidyverse</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>I'll be using examples of spreadsheets that were designed for data entry, not necessarily statistical modeling or graphics. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>My goal is that by showing the reasoning behind the data entry process, you'll walk away with a better understanding (and hopefully a little less frustration) for why data are collected in so many different ways. </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":1} -->
<h1>Part one: Tidy data</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p><a href="https://www.jstatsoft.org/article/view/v059i10">Tidy data</a> is… <em>"a standardized way to link the structure of a dataset (its physical layout) with its semantics (its meaning)"</em></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you’ve worked with SQL and relational databases, you’ll recognize most of these concepts. Hadley Wickham distilled a lot of the technical jargon from <a href="https://en.wikipedia.org/wiki/Third_normal_form">Edgar F. Codd’s 'normal form'</a> and applied it to statistical terms. More importantly, he translated these essential principles into concepts and terms a broader audience can grasp and use for data manipulation. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Get the data and code to follow along <a href="https://github.com/mjfrigaard/storybenchR/tree/master/02.1-tidyr-tidyverse">here</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted"># load data from Github <br>base::load(file = "data/tidyr-data.RData")</pre>
<!-- /wp:preformatted -->

<!-- wp:heading -->
<h2>The tidy data principles</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Tidy data refers to 'rectangular' data. These are the data we typically see in spreadsheet software like Googlesheets, Microsoft Excel, or in a relational database like MySQL, PostgreSQL, or Microsoft Access, The three principles for tidy data are:</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>Variables make up the columns  </li><li>Observations (or cases) go in the rows  </li><li>Values are in cells  </li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Put them together, and these three statements make up the contents in a tidy <a href="https://tibble.tidyverse.org/">data frame or tibble</a>. While these principles might seem obvious at first, many of the data arrangements we encounter in real life don't adhere to this guidance.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3>Indexed vs. Cartesian</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I prefer to refer to tidy data as "indexed", and wide data as "Cartesian" (this terminology is from the <a href="https://amzn.to/2UlyNNp">ggplot2</a> text) because these terms help me understand what is happening when the data get transformed. Two examples are below:</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4>Indexed data</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In the <code>Indexed</code> data frame, the <code>group</code> and <code>number</code> variables are used to keep track of each unique value of <code>measure</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">Indexed</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 5 x 3
  group number measure
  &lt;chr> &lt;chr>    &lt;dbl>
1 A     ID001     1098
2 C     ID001     3049
3 D     ID003     2394
4 B     ID004     9301
5 C     ID006     4092</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>The same data are represented in the <code>Cartesian</code> data frame, but in this table the <code>measure</code> values are at the intersection of <code>group</code> and each <code>ID###</code> (the <code>number</code> from the previous table). </p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">Cartesian<br></pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code -->
<pre class="wp-block-syntaxhighlighter-code brush: plain; notranslate"># A tibble: 4 x 5
  group ID001 ID003 ID004 ID006
  &lt;chr> &lt;dbl> &lt;dbl> &lt;dbl> &lt;dbl>
1 A      1098    NA    NA    NA
2 B        NA    NA  9301    NA
3 C      3049    NA    NA  4092
4 D        NA  2394    NA    NA</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>As you can see, the <code>Cartesian</code> orientation uses up more columns (and<br>fills in the gaps with missing (<code>NA</code>) values).</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/indexed-carteisan.png?raw=true" alt=""/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":1} -->
<h1>Part two: Grouping</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Grouping produces summary data tables using functions from the <code>dplyr</code> package. Similar to <code>GROUP BY</code> in SQL, <code>dplyr::group_by()</code> silently groups a data frame (which means we don't see any changes) and then applies aggregate functions using <code>dplyr::summarize()</code>. Examples of these are <code>mean()</code>, <code>median()</code>, <code>sum()</code>, <code>n()</code>, <code>sd()</code>, etc.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Take the data frame below, <code>DataTibble</code>, which has 5 variables: </p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li><code>group_var</code> - a categorical group </li><li><code>year</code> - the calendar year the measurements were collected </li><li><code>x_measurement</code> and <code>y_measurement</code> - these are randomly generated numbers</li><li> <code>ordinal_y_var</code> - this is an ordinal variable corresponding to the values in <code>y_measurement</code> (greater than or equal to <code>800</code> is <code>"high"</code> or <code>3</code>, greater than or equal to <code>500</code> and less than <code>750</code> is <code>"med"</code> or <code>2</code>, and less than <code>500</code> is <code>"low"</code> or <code>1</code>). </li></ul>
<!-- /wp:list -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DataTibble</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code -->
<pre class="wp-block-syntaxhighlighter-code brush: plain; notranslate"># A tibble: 8 x 5
  group_var  year x_measurement y_measurement ordinal_y_var
  &lt;chr>     &lt;dbl>         &lt;dbl>         &lt;dbl> &lt;fct>        
1 A          2018          11.8          532. med          
2 A          2017          28.5          116. low          
3 A          2016          49.2          304. low          
4 B          2018          87.6          719. med          
5 B          2017          11.3          984. high         
6 C          2018          15.9          959. high         
7 C          2017          63.8          962. high         
8 C          2016          96.0          745. med </pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>If I apply <code>dplyr::group_by()</code> to the <code>group_var</code> in <code>DataTibble</code>, I will see no visible result.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DataTibble %&gt;% <br>    dplyr::group_by(group_var)</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 8 x 5
# Groups:   group_var [3]
  group_var  year x_measurement y_measurement ordinal_y_var
  &lt;chr>     &lt;dbl>         &lt;dbl>         &lt;dbl> &lt;fct>        
1 A          2018          11.8          532. med          
2 A          2017          28.5          116. low          
3 A          2016          49.2          304. low          
4 B          2018          87.6          719. med          
5 B          2017          11.3          984. high         
6 C          2018          15.9          959. high         
7 C          2017          63.8          962. high         
8 C          2016          96.0          745. med   </pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>But when I combine <code>dplyr::group_by()</code> with <code>dplyr::summarize()</code>, I can collapse <code>DataTibble</code> into a smaller table by supplying an aggregate function to <code>summarize()</code>. Below I use <code>summarize()</code> to get the mean of <code>x_measurement</code> and <code>y_messurement</code> and <code>n()</code> to get the total number in each group.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DataTibble %&gt;% <br>  dplyr::group_by(group_var) %&gt;% <br>  dplyr::summarize(x_mean = mean(x_measurement),     <br>                   y_mean = mean(y_measurement),     <br>                   no = n())</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 3 x 4
  group_var x_mean y_mean    no
  &lt;chr>      &lt;dbl>  &lt;dbl> &lt;int>
1 A           29.8   318.     3
2 B           49.4   852.     2
3 C           58.6   889.     3</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>Grouping can also work with categorical/factor variables. The code below uses <code>dplyr::count()</code> to summarize the number of <code>ordinal_y_var</code> levels per category of <code>group_var</code></p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DataTibble %&gt;% <br>      dplyr::count(group_var, ordinal_y_var)</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code -->
<pre class="wp-block-syntaxhighlighter-code brush: plain; notranslate"># A tibble: 6 x 3
  group_var ordinal_y_var     n
  &lt;chr>     &lt;fct>         &lt;int>
1 A         med               1
2 A         low               2
3 B         high              1
4 B         med               1
5 C         high              2
6 C         med               1</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>This table isn't as easy to read, because all of the information is oriented vertically. I can move the values of <code>group_var</code> into individual columns to make it easier on the eyes using <code>tidyr::spread()</code></p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DataTibble %&gt;% <br>    dplyr::count(group_var,ordinal_y_var) %&gt;% <br>    tidyr::spread(key = group_var,value = n)</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 3 x 4
  ordinal_y_var     A     B     C
  &lt;fct>         &lt;int> &lt;int> &lt;int>
1 high             NA     1     2
2 med               1     1     1
3 low               2    NA    NA</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>Notice how this creates a table with different dimensions? This arrangement can quickly be undone with the accompanying <code>tidyr::gather()</code> function. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><code>tidyr::gather()</code> works a lot like the <code>tidyr::spread()</code> function, but also requires us to specify that the missing values should be removed (<code>na.rm = TRUE</code>). </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>I also added a <code>dplyr::select()</code> statement to arrange these values so they are similar to the table above</em>.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">DataTibble %&gt;%<br>   dplyr::count(group_var, ordinal_y_var) %&gt;%<br>   tidyr::spread(key = group_var, value = n) %&gt;%<br>   tidyr::gather(key = group_var, value = "n", <br>                 -ordinal_y_var, na.rm = TRUE) %&gt;%<br>   dplyr::select(group_var, ordinal_y_var, n)</pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 6 x 3
  group_var ordinal_y_var     n
  &lt;chr>     &lt;fct>         &lt;int>
1 A         med               1
2 A         low               2
3 B         high              1
4 B         med               1
5 C         high              2
6 C         med               1</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:heading {"level":1} -->
<h1>Part three: Pivoting</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>All this data manipulation brings us to <em>pivoting</em>, the <a href="https://tidyr.tidyverse.org/dev/articles/pivot.html">recent additions</a> to the <code>tidyr</code> package. These will be slowly replacing the functions I used above for reshaping data frames, <code>tidyr::gather()</code> and <code>tidyr::spread()</code>. I found it refreshing to learn that I wasn't the only person struggling to use these functions. Hadley Wickham, the package developer/author, confessed he also struggles when using these functions,</p>
<!-- /wp:paragraph -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><p>Many people don’t find the names intuitive and find it hard to remember which direction corresponds to spreading and which to gathering. It also seems surprisingly hard to remember the arguments to these functions, meaning that many people (including me!) have to consult the documentation every time.</p></blockquote>
<!-- /wp:quote -->

<!-- wp:paragraph -->
<p>Decisions like these are examples of why I appreciate the <code>tidyverse</code>, because I can tell a lot of thought gets put into identifying language that accurately capture the users intentions. Knowing how to reshape data is an important skill for any data scientist, and the <code>tidyr::pivot_</code> functions make restructuring very clear and explicit. </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>Pivoting == fancy footwork</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Vasily Lomachenko, the best <a href="https://en.wikipedia.org/wiki/Boxing_pound_for_pound_rankings">pound-for-pound boxer</a> in the world, is known for taking <a href="https://sports.yahoo.com/quitting-boxing-dance-made-vasyl-lomachenko-better-fighter-195049319.html">traditional Ukrainian dance classes as a child before ever stepping into a boxing ring</a>. Why would an athlete who punches people for a living spend time learning how to dance? Because dancing is an excellent way to develop movement with precision, and <strong>having the ability to quickly change angles is so essential in boxing that these skills are often what separates a good fighter from an elite athlete</strong>.</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/loma-pivot.gif?raw=true" alt=""/><figcaption>"I think footwork is one of the most important things to becoming a great fighter. That's where everything starts." - Vasyl Lomachenko</figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>Whenever we use the <code>pivot_</code> functions, we're changing angles between the columns and rows. If the tables are pivoting from wide to longer, the column names and values rotate 90˚ into an index row. </p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/pivot-longer-image.png?raw=true" alt=""/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>When pivoting from long to wide, the index variable shifts across the column names, and the values slide in underneath the names.</p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/pivot-wider-image.png?raw=true" alt=""/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The <code>tidyr::pivot_</code> functions give users the ability to quickly pivot (change angles) their data, and being able to rotate your data from columns to rows (and back) is similar to being able to rotate 90˚ on a dime and avoid an incoming hook.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>As a skill, it's also a great place to start because most to the data you'll encounter in the <code>tidyverse</code> is going to be in columns and rows (or you will want to get them that way).</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":1} -->
<h1>Pivoting Example 1: Categorical/ordinal variable across multiple columns</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We're going to start by manipulating a data set of Lomachenko's fights from the <a href="http://boxrec.com/en/boxer/659771">BoxRec</a> database. The fight information is oriented in a way that makes sense for the person entering the data, but it's not ideal for analysis or modeling.</p>
<!-- /wp:paragraph -->

<!-- wp:html -->
<pre>
LomaWideSmall
</pre>
<!-- /wp:html -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate">opponent       date fight_1 fight_2 fight_3 fight_4 fight_5 fight_6 fight_7 fight_8 fight_9 fight_10 fight_11 fight_12 fight_13 fight_14
1            José Ramírez 2013-10-12     Win    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
2          Orlando Salido 2014-03-01    &lt;NA>    Loss    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
3        Gary Russell Jr. 2014-06-21    &lt;NA>    &lt;NA>     Win    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
4  Chonlatarn Piriyapinyo 2014-11-22    &lt;NA>    &lt;NA>    &lt;NA>     Win    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
5      Gamalier Rodríguez 2015-05-02    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     Win    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
6         Romulo Koasicha 2015-11-07    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     Win    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
7          Román Martínez 2016-06-11    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     Win    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
8        Nicholas Walters 2016-11-26    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     Win    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
9              Jason Sosa 2017-04-08    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     Win     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
10        Miguel Marriaga 2017-08-05    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>      Win     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>
11   Guillermo Rigondeaux 2017-12-09    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>      Win     &lt;NA>     &lt;NA>     &lt;NA>
12          Jorge Linares 2018-05-12    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>      Win     &lt;NA>     &lt;NA>
13           José Pedraza 2018-12-08    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>      Win     &lt;NA>
14         Anthony Crolla 2019-04-12    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>    &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA>     &lt;NA></pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>This data arrangement is <em>Cartesian</em>, because each fight number has it's own column (<code>fight_1</code> through <code>fight_14</code>), and the result (<code>Win</code>/<code>Loss</code>) is located at the intersection between the fight numbered columns and the corresponding <code>opponent</code> and <code>date</code>. Having the data in this arrangement might seem odd to a data scientist, but this configuration makes sense for a fan entering the fights into a spreadsheet <strong>as they happen in real time</strong>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p> Consider the the chronological chain of events involved with a each fight, </p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>An <code>opponent</code> is announced, and an excited fan enters the information into the first two column/rows in a spreadsheet and titles it, 'Lomachenko`</li><li>The <code>date</code> for the first fight gets entered into the <code>B</code> column (the second in the table), </li><li>In order to track an athlete's win/loss record over the course of their career, a number is also marked for each fight (starting with <code>1</code>) in a column titled, <code>fight_1</code>. and the result gets put in the corresponding cell (<code>Win</code> or <code>Loss</code>)</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>As you can see, the steps above are sensible for someone wanting to track their favorite athlete (or sports team) over time. I've encountered many excel tables with orientations that mirror the sequence of events they're capturing. This "data-entry friendly" format captures enough information to be useful, and it has a few computational abilities. For example, a fan could use filtering to count the number of matches against a particular <code>opponent</code>, or sort the <code>date</code> column to figure what Lomachenko's late fight. Spreadsheets like these are a cross between a timeline and a record book, and they do a good enough job at both tasks to justify their current structure.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The <a href="https://tidyr.tidyverse.org/dev/articles/pivot.html#wide-to-long">pivot vignette</a> conveys that 'wide' formats or data arrangements are common because their primary purpose and design is centered around recording data (and not visualization or modeling).</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>Pivoting long</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>We are going to start by pivoting the <code>LomaWideSmall</code> data frame to a long or 'tidy' format. We accomplish this using the <code>tidyr::pivot_longer()</code> function. </p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">LomaWideSmall %>% <br>   tidyr::pivot_longer(<br>     cols = starts_with("fight"), <br>     names_to = "fight_no", <br>     values_to = "result", <br>     names_prefix = "fight_", <br>     na.rm = TRUE)<br></pre>
<!-- /wp:preformatted -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate">A tibble: 13 x 4
 opponent               date       fight_no result                         
  1 José Ramírez           2013-10-12 1        Win   
  2 Orlando Salido         2014-03-01 2        Loss  
  3 Gary Russell Jr.       2014-06-21 3        Win   
  4 Chonlatarn Piriyapinyo 2014-11-22 4        Win   
  5 Gamalier Rodríguez     2015-05-02 5        Win   
  6 Romulo Koasicha        2015-11-07 6        Win   
  7 Román Martínez         2016-06-11 7        Win   
  8 Nicholas Walters       2016-11-26 8        Win   
  9 Jason Sosa             2017-04-08 9        Win   
 10 Miguel Marriaga        2017-08-05 10       Win   
 11 Guillermo Rigondeaux   2017-12-09 11       Win   
 12 Jorge Linares          2018-05-12 12       Win   
 13 José Pedraza           2018-12-08 13       Win</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:heading {"level":3} -->
<h3>What happens in pivot_longer()?</h3>
<!-- /wp:heading -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/tidy-pivoting-longer.png?raw=true" alt=""/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p><code>tidyr::pivot_longer()</code> extends the <code>tidyr::spread()</code> function by adding a few arguments to make this re-structuring more deliberate:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li>The <code>cols</code> argument contains the columns we want to pivot (and it takes <a href="https://dplyr.tidyverse.org/reference/select.html"><code>tidyselect</code></a> helper functions). These are going to be the new index columns.</li><li>The <code>names_to</code> and <code>values_to</code> are the new columns we will be creating from all of the <code>fight_</code> variables. The <code>names_to</code> is the new index column, meaning how would you 'look up' the value in an adjacent column. The <code>values_to</code> are the contents of the cells that correspond to each value in the <code>names_to</code> variable. </li><li>The <code>names_prefix</code> is a regular expression pattern I can use to clean the old variable names as they become the values in the new columns. I enter <code>fight_</code> here because is will remove the text from the front the variable name and only enter the number into the new <code>fight_no</code> variable.</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Unfortunately, we can see that the new <code>fight_no</code> variable is still formatted as a character. Luckily, the new <code>tidyr::pivot_longer()</code> function also has a <code>tidyr::pivot_longer_spec()</code>, which allows for additional specifications on the data transformation.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>Pivoting longer (with specifications)</h2>
<!-- /wp:heading -->

<!-- wp:quote -->
<blockquote class="wp-block-quote"><p><em>A pivoting </em><code><em>spec</em></code><em> is a data frame that describes the metadata stored in the column name, with one row for each column, and one column for each variable mashed into the column name. </em></p></blockquote>
<!-- /wp:quote -->

<!-- wp:paragraph -->
<p>The <code>tidyr::pivot_longer_spec()</code> function allows even more specifications on what to do with the data during the transformation. Because we are still in the <code>tidyverse</code>, the output is a data fame. Explicitly creating an object that contains data about your data is not necessarily a novel concept in R, but it's very handy when that object is similar to the other objects you're already working with (i.e. a data frame or tibble).  </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Creating a <code>spec</code> for the <code>LomaWideSmall</code> data frame is a three-step process:</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4>1) Define the arguments for reshaping the data</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>I enter the same arguments I entered above in the <code>tidyr::pivot_longer()</code> function, with the exception of the <code>na.rm = TRUE</code> argument. These results get stored into an object I will name <code>LomaSpec</code>, which is a data frame with three variables in it: <code>.name</code>, <code>.value</code>, and <code>fight_no</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted">LomaWideSmall %&gt;% <br>   tidyr::pivot_longer_spec(<br>      cols = starts_with("fight"), <br>      names_to = "fight_no", <br>      values_to = "result", <br>      names_prefix = "fight_")<br>LomaSpec </pre>
<!-- /wp:preformatted -->

<!-- wp:paragraph -->
<p>This produces the following (if you're looking at the output in the R console).</p>
<!-- /wp:paragraph -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate">A tibble: 14 x 3
 .name    .value fight_no
  1 fight_1  result 1       
  2 fight_2  result 2       
  3 fight_3  result 3       
  4 fight_4  result 4       
  5 fight_5  result 5       
  6 fight_6  result 6       
  7 fight_7  result 7       
  8 fight_8  result 8       
  9 fight_9  result 9       
 10 fight_10 result 10      
 11 fight_11 result 11      
 12 fight_12 result 12      
 13 fight_13 result 13      
 14 fight_14 result 14  </pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>The three columns in <code>LomaSpec</code> contain metadata (data about our data) on the transformation I want to perform--specifically the original columns (<code>.name</code>) and the corresponding cell values (<code>.value</code>). The other variable (<code>fight_no</code>) gets carried over from the transformation as well. </p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":4} -->
<h4>2) Format the variable(s) in the spec</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>If I want to format the <code>fight_no</code> variable, I can include those arguments <em>within</em> the <code>LomaSpec</code> data frame.</p>
<!-- /wp:paragraph -->

<!-- wp:preformatted -->
<pre class="wp-block-preformatted"># format the variable<br> LomaSpec &lt;- LomaSpec %&gt;%<br> dplyr::mutate(fight_no = as.numeric(fight_no))<br> LomaSpec$fight_no %&gt;% glimpse(78)<br># num [1:14] 1 2 3 4 5 6 7 8 9 10 ...</pre>
<!-- /wp:preformatted -->

<!-- wp:heading {"level":4} -->
<h4>3) Supply the formatted spec object to pivot_longer_spec() function</h4>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Now <code>LomaSpec</code> can get supplied to the <code>tidyr::pivot_longer()</code> function and the <code>fight_no</code> variable is properly formatted (note I still need to provide the <code>na.rm = TRUE</code> argument).</p>
<!-- /wp:paragraph -->

<!-- wp:html -->
<pre># supply it to the pivot_longer
LomaFightsLong % 
    tidyr::pivot_longer(spec = LomaSpec, 
                        na.rm = TRUE) 
LomaFightsLong
</pre>
<!-- /wp:html -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 13 x 4
   opponent               date       fight_no result
                               
 1 José Ramírez           2013-10-12        1 Win   
 2 Orlando Salido         2014-03-01        2 Loss  
 3 Gary Russell Jr.       2014-06-21        3 Win   
 4 Chonlatarn Piriyapinyo 2014-11-22        4 Win   
 5 Gamalier Rodríguez     2015-05-02        5 Win   
 6 Romulo Koasicha        2015-11-07        6 Win   
 7 Román Martínez         2016-06-11        7 Win   
 8 Nicholas Walters       2016-11-26        8 Win   
 9 Jason Sosa             2017-04-08        9 Win   
10 Miguel Marriaga        2017-08-05       10 Win   
11 Guillermo Rigondeaux   2017-12-09       11 Win   
12 Jorge Linares          2018-05-12       12 Win   
13 José Pedraza           2018-12-08       13 Win </pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>These data are now in a tidy (indexed) format. </p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>Pivoting wider</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>No one wins a boxing match by only avoiding punches--eventually they have to hit someone (and probably more than once). Another reason that being able to change angles quickly is advantageous is that it creates more opportunities to throw (and land) punches. As you can see below, Lomachenko's pivoting abilities not only make him frustratingly hard to hit, but they also allow him to see openings in his opponents defenses (which makes him incredibly successful at landing punches).  </p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/loma-pivot-strike.gif?raw=true" alt=""/></figure>
<!-- /wp:image -->

<!-- wp:heading {"level":1} -->
<h1>Pivoting Example 2: Moving categorical or ordinal variables across columns</h1>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>It's less common, but sometimes you'll need to move variables from a tidy (or indexed) column arrangement into a wide (Cartesian) format. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In order to restructure from a wide to long data frame, we need to use the <code>tidyr::pivot_wider()</code> function. This works much like the <code>pivot_longer()</code> function, but with a few different arguments. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Consider a data frame with the same Lomachenko fight records, but this time arranged by date. Imagine the following events that would lead to the creation of the <code>LomaDatesWide</code> data:It's announced that Lomachenko will be fighting an <code>opponent</code> and the <code>location</code> is announced, and our fan enters the information into the first two column/rows in her 'Lomachenko` spreadsheet </p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>It's announced that Lomachenko will be fighting an <code>opponent</code> and <code>location</code> is announced, and our fan enters the information into the first two column/rows in her 'Lomachenko` spreadsheet </li><li>A <code>fight_number</code> column is created to document the number of fights (as they happen)</li><li>The date for the first fight (<code>2013-10-12</code>) gets entered into the the fourth column in the table, and the result (<code>Win</code>) gets put in the corresponding cell</li><li>After the scorecards are collected, the <code>result</code> is announced (see key below), the <code>fight_record</code> is updated (with the official outcome of the bout)</li><li>The official round and time (<code>rounds</code> and <code>time</code>) is recorded for when the fight had to stop (or the total number of rounds if it went the distance), </li><li>Titles and belts are listed in the <code>notes</code> section</li><li>When the next fight happens, our fan right-clicks on the last recorded fight, and inserts a new column and date, and repeats steps 1-6</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><em>I tend to find tables like these when the data entry is done using 'Freeze Columns' or 'Freeze Rows'.</em></p>
<!-- /wp:paragraph -->

<!-- wp:image -->
<figure class="wp-block-image"><img src="https://github.com/mjfrigaard/storybenchR/blob/master/02.1-tidyr-tidyverse/images/freeze-cells.gif?raw=true" alt=""/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The <code>LomaFights</code> data frame has Lomachenko's fight records from his <a href="https://en.wikipedia.org/wiki/Vasyl_Lomachenko">wikipedia table</a>. To create a spreadsheet like the one above, we can use the <code>tidyr::pivot_wider()</code> function. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><em>I add a few </em><code><em>dplyr</em></code><em> functions to get the data frame to look identical to the excel file above.</em> </p>
<!-- /wp:paragraph -->

<!-- wp:html -->
<pre>LomaFights %&gt;% 
    # the columns come from the dates
    tidyr::pivot_wider(names_from = date, 
                       # the values will be the result of the fight
                       values_from = result) %&gt;% 
    # arrange by the fight number 
    dplyr::arrange(no) %&gt;% 
    # rearrange the columns
    dplyr::select(opponent, location,
                  dplyr::starts_with("20"),
                  dplyr::everything())
</pre>
<!-- /wp:html -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 14 x 22
   opponent   location      `2013-10-12` `2014-03-01` `2014-06-21` `2014-11-22` `2015-05-02` `2015-11-07` `2016-06-11` `2016-11-26` `2017-04-08` `2017-08-05` `2017-12-09` `2018-05-12` `2018-12-08` `2019-04-12`    no record type  rounds time  notes       
   &lt;chr>      &lt;chr>         &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;int> &lt;chr>  &lt;chr> &lt;chr>  &lt;chr> &lt;chr>       
 1 José Ramí… Thomas &amp; Mac… Win          NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA               1 1–0    TKO   4 (10) 2:55  Won WBO Int…
 2 Orlando S… Alamodome, S… NA           Loss         NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA               2 1–1    SD    12     NA    For vacant …
 3 Gary Russ… StubHub Cent… NA           NA           Win          NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA               3 2–1    MD    12     NA    Won vacant …
 4 Chonlatar… Cotai Arena,… NA           NA           NA           Win          NA           NA           NA           NA           NA           NA           NA           NA           NA           NA               4 3–1    UD    12     NA    Retained WB…
 5 Gamalier … MGM Grand Ga… NA           NA           NA           NA           Win          NA           NA           NA           NA           NA           NA           NA           NA           NA               5 4–1    KO    9 (12) 0:50  Retained WB…
 6 Romulo Ko… Thomas &amp; Mac… NA           NA           NA           NA           NA           Win          NA           NA           NA           NA           NA           NA           NA           NA               6 5–1    KO    10 (1… 2:35  Retained WB…
 7 Román Mar… The Theater … NA           NA           NA           NA           NA           NA           Win          NA           NA           NA           NA           NA           NA           NA               7 6–1    KO    5 (12) 1:09  Won WBO jun…
 8 Nicholas … Cosmopolitan… NA           NA           NA           NA           NA           NA           NA           Win          NA           NA           NA           NA           NA           NA               8 7–1    RTD   7 (12) 3:00  Retained WB…
 9 Jason Sosa MGM National… NA           NA           NA           NA           NA           NA           NA           NA           Win          NA           NA           NA           NA           NA               9 8–1    RTD   9 (12) 3:00  Retained WB…
10 Miguel Ma… Microsoft Th… NA           NA           NA           NA           NA           NA           NA           NA           NA           Win          NA           NA           NA           NA              10 9–1    RTD   7 (12) 3:00  Retained WB…
11 Guillermo… The Theater … NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           Win          NA           NA           NA              11 10–1   RTD   6 (12) 3:00  Retained WB…
12 Jorge Lin… Madison Squa… NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           Win          NA           NA              12 11–1   TKO   10 (1… 2:08  Won WBA (Su…
13 José Pedr… Hulu Theater… NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           Win          NA              13 12–1   UD    12     NA    Retained WB…
14 Anthony C… Staples Cent… NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA           NA              14 NA     NA    NA     NA    Defending W…</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:heading -->
<h2>Pivoting wider options</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The output is <em>very</em> close to the excel sheet above, except missing values in excel are empty (not an <code>NA</code> like R). I can use the <code>tidyr::pivot_wider(x, values_fill())</code> to include this change to the data.</p>
<!-- /wp:paragraph -->

<!-- wp:html -->
<pre>LomaFights %>% <br>
    tidyr::pivot_wider(names_from = date, <br>
                       values_from = result,<br>
                       values_fill = list(result = "")) %>% <br>
    dplyr::arrange(no) %>% <br>
    dplyr::select(opponent, <br>
                  location,<br>
                  dplyr::starts_with("20"),<br>
</pre>
<!-- /wp:html -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 14 x 16
   opponent            location                                          `2013-10-12` `2014-03-01` `2014-06-21` `2014-11-22` `2015-05-02` `2015-11-07` `2016-06-11` `2016-11-26` `2017-04-08` `2017-08-05` `2017-12-09` `2018-05-12` `2018-12-08` `2019-04-12`
   &lt;chr>               &lt;chr>                                             &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>        &lt;chr>       
 1 José Ramírez        Thomas &amp; Mack Center, Paradise, Nevada, US        Win          ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""          
 2 Orlando Salido      Alamodome, San Antonio, Texas, US                 ""           Loss         ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""          
 3 Gary Russell Jr.    StubHub Center, Carson, California, US            ""           ""           Win          ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""          
 4 Chonlatarn Piriyap… Cotai Arena, Macau, SAR                           ""           ""           ""           Win          ""           ""           ""           ""           ""           ""           ""           ""           ""           ""          
 5 Gamalier Rodríguez  MGM Grand Garden Arena, Paradise, Nevada, US      ""           ""           ""           ""           Win          ""           ""           ""           ""           ""           ""           ""           ""           ""          
 6 Romulo Koasicha     Thomas &amp; Mack Center, Paradise, Nevada, US        ""           ""           ""           ""           ""           Win          ""           ""           ""           ""           ""           ""           ""           ""          
 7 Román Martínez      The Theater at Madison Square Garden, New York C… ""           ""           ""           ""           ""           ""           Win          ""           ""           ""           ""           ""           ""           ""          
 8 Nicholas Walters    Cosmopolitan of Las Vegas, Paradise, Nevada, US   ""           ""           ""           ""           ""           ""           ""           Win          ""           ""           ""           ""           ""           ""          
 9 Jason Sosa          MGM National Harbor, Oxon Hill, Maryland, US      ""           ""           ""           ""           ""           ""           ""           ""           Win          ""           ""           ""           ""           ""          
10 Miguel Marriaga     Microsoft Theater, Los Angeles, California, US    ""           ""           ""           ""           ""           ""           ""           ""           ""           Win          ""           ""           ""           ""          
11 Guillermo Rigondea… The Theater at Madison Square Garden, New York C… ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           Win          ""           ""           ""          
12 Jorge Linares       Madison Square Garden, New York City, New York, … ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           Win          ""           ""          
13 José Pedraza        Hulu Theater, New York City, New York, US         ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           Win          ""          
14 Anthony Crolla      Staples Center, Los Angeles, California, US       ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           ""           NA          </pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>Another neat part of the <code>pivot_wider()</code> function is the <code>values_from</code> argument can take multiple columns. For example, if I wanted to see how man <code>Win</code>s resulted in <code>TKO</code>s (technical knock-outs) or <code>KO</code>s (knock-outs) and their corresponding rounds and time, I could use the following to see <code>rounds</code> and <code>time</code> in separate columns.</p>
<!-- /wp:paragraph -->

<!-- wp:html -->
<pre>
LomaFights %>% <br>
    dplyr::filter(result == "Win") %>% <br>
    pivot_wider(names_from = c(type),<br>
                values_from = c(rounds, time),<br>
                values_fill = list(rounds = "",<br>
                                   time = "")) %>% <br>
    dplyr::select(opponent,<br>
                  dplyr::contains("_KO"),<br>
                  dplyr::contains("_TKO"))<br>
</pre>
<!-- /wp:html -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 12 x 5
   opponent               rounds_KO time_KO rounds_TKO time_TKO
   &lt;chr>                  &lt;chr>     &lt;chr>   &lt;chr>      &lt;chr>   
 1 José Ramírez           ""        ""      4 (10)     2:55    
 2 Gary Russell Jr.       ""        ""      ""         ""      
 3 Chonlatarn Piriyapinyo ""        ""      ""         ""      
 4 Gamalier Rodríguez     9 (12)    0:50    ""         ""      
 5 Romulo Koasicha        10 (12)   2:35    ""         ""      
 6 Román Martínez         5 (12)    1:09    ""         ""      
 7 Nicholas Walters       ""        ""      ""         ""      
 8 Jason Sosa             ""        ""      ""         ""      
 9 Miguel Marriaga        ""        ""      ""         ""      
10 Guillermo Rigondeaux   ""        ""      ""         ""      
11 Jorge Linares          ""        ""      10 (12)    2:08    
12 José Pedraza           ""        ""      ""         ""   </pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>We can also use the <code>tidyr::pivot_wider()</code> function like <code>tidyr::spread()</code> function above. If I want to see the fight <code>results</code> by type, but with <code>Win</code> and <code>Loss</code> in separate columns, I can use the following sequence. </p>
<!-- /wp:paragraph -->

<!-- wp:html -->
<pre>
LomaFights %>% <br>
    dplyr::filter(!is.na(result)) %>% <br>
    dplyr::count(type, result) %>% <br>
    tidyr::pivot_wider(<br>
            names_from = result, <br>
            values_from = n,<br>
            values_fill = list(n = 0))
</pre>
<!-- /wp:html -->

<!-- wp:syntaxhighlighter/code {"language":"r"} -->
<pre class="wp-block-syntaxhighlighter-code brush: r; notranslate"># A tibble: 6 x 3
  type    Win  Loss
  &lt;chr> &lt;int> &lt;int>
1 KO        3     0
2 MD        1     0
3 RTD       4     0
4 SD        0     1
5 TKO       2     0
6 UD        2     0</pre>
<!-- /wp:syntaxhighlighter/code -->

<!-- wp:paragraph -->
<p>As you can see, these new <code>tidyr::pivot_</code> functions extend <code>tidyr::gather()</code> and <code>tidyr::spread()</code> with more options and flexibility. I think you'll find these are a welcome addition to all of the data manipulation in the <code>tidyverse</code>.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2>Read more</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Check out the <a href="https://tidyr.tidyverse.org/dev/articles/pivot.html">pivoting vignette</a> on the tidyverse website. </li><li>Alison Presmanes Hill has some great examples in this <a href="https://github.com/apreshill/teachthat/tree/master/pivot">Github repo</a>.</li><li>Read the <a href="https://github.com/tidyverse/tidyr/blob/master/NEWS.md"><code>NEWS.md</code> file</a> on the <code>tidyr</code> github page for new changes to these functions (and others!) </li><li>Be sure to check out <a href="https://es.pn/2CUzPFl">Vasiliy Lomachenko when he fights Anthony Crolla</a> on April 12!</li></ul>
<!-- /wp:list -->